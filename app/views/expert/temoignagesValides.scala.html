@*********************************************************************************
 * 
 *   Copyright 2014 BOUSSEJRA Malik Olivier, HALDEBIQUE Geoffroy, ROYER Johan
 *
 *   Licensed under the Apache License, Version 2.0 (the "License");
 *   you may not use this file except in compliance with the License.
 *   You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 *   
 ********************************************************************************@
 @(listObservation: List[Observation], page: Integer, nbpages: Integer, groupe : Groupe, listEspeces: List[Espece] )
 @main("Témoignages validés"){<header>
		<dl>
		<a href="/">Retour</a>
		</dl>
		<h1> Pages des témoignages validés </h1>
	</header>
	<p>Trier par espece:<select name="selespesce" onchange="triEspece(@groupe.groupe_id, this.options[this.selectedIndex].value)">
				<option value="-1">&nbsp </option>
				<option value="toutes"> Toutes les espèces </option>
				@for(espece <- listEspeces){
					<option value="@espece.espece_id">@espece.espece_nom</option>
					}
				</select><span id="tri"></span></p>
		@for( pg:Int <- 1 to nbpages){<a href="/temoignagesValides/@groupe.groupe_id/@pg">p.@pg</a>
		}
	 <table>
        	<tr>
        		
        		<th>Témoins</th>
        		<th>Espèce</th>
        		<th>Déterminateur</th>
        		<th>Commentaires</th>
        		<th>Date d'observation</th>
        		<th>Lieu-dit</th>
        		<th>Commune</th>
        		<th>UTMS</th>
        		<th>Memo</th>
        		<th>Date de soumission</th>
        		<th>Informations supplémentaires</th>
        		<th>Date de validation</th>
        		<th>Remettre en suspens</th>
        	</tr>
        	@for(observation <- listObservation) {
        	<tr>
        	
        		<td>@for(ficheHasMembre <-observation.observation_fiche.getFicheHasMembre()){ @ficheHasMembre.membre} 
        		</td>
        		<td>@observation.observation_espece.espece_nom</td>
        		<td>@observation.observation_determinateur</td>
        		<td>@observation.observation_commentaires</td>
        		<td>@observation.observation_fiche.fiche_date.getTime().format("dd/MM/yyyy")</td>
        		<td>@observation.observation_fiche.fiche_lieudit</td>
        		<td>@if(observation.observation_fiche.fiche_commune!=null){@observation.observation_fiche.fiche_commune.ville_nom_reel}</td>
        		<td>@observation.observation_fiche.fiche_utm.utm</td>
        		<td>@observation.observation_fiche.fiche_memo</td>
        		<td>@observation.observation_fiche.fiche_date_soumission.getTime().format("dd/MM/yyyy")</td>
        		<td>@for(informationsComplementaires <-observation.getInfos()){
        			@informationsComplementaires.informations_complementaires_nombre_de_specimens
        			@informationsComplementaires.informations_complementaires_stade_sexe
        			} </td>
        		<td>@observation.observation_date_validation.getTime().format("dd/MM/yyyy")</td>
        		<td><form id="suspens@observation.observation_id" method="POST" action="/temoignagesValides/suspens/@groupe.groupe_id/@page/@observation.observation_id"><input type="button" onclick="confirmSuspens(@observation.observation_id)" value="Remettre en Suspens"></form></td>
        		
        	</tr>}
        </table>
	}{<script>
	function confirmSuspens(observation_id){
	var r=confirm("Etes-vous sûr de remettre cette observation en suspens?");
	if(r==true)
		{
		document.getElementById("suspens"+observation_id).submit();
		}
		else
		{}
	}
	function triEspece(groupe_id, espece_id){
	if (espece_id=="toutes"){document.getElementById("tri").innerHTML='<a href="/temoignagesValides/'+groupe_id+'/1"><button>Trier</button></a>';
	}else{
	document.getElementById("tri").innerHTML='<a href="/temoignagesValides/'+groupe_id+'/'+espece_id+'/1"><button>Trier</button></a>';}
	}
	</script>
}

